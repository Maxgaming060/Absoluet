"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),snipeManager_1=tslib_1.__importDefault(require("../../helpers/snipeManager")),discord_js_1=require("discord.js"),replaceAll_1=tslib_1.__importDefault(require("../../helpers/replaceAll")),Event_1=require("../../structures/Event"),querys_1=require("../../helpers/querys"),__1=require("../..");exports.default=new Event_1.Event("messageDelete",(e=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){if(!e.content)return;yield snipeManager_1.default.addSnipe(e);const t=yield(0,querys_1.guilds)().get(e.guildId);if(t.filtersConfig.ghostPing){if(e.channel.type===discord_js_1.ChannelType.DM||e.author.bot)return;if(e.member.roles.cache.some((e=>t.filtersConfig.bypassRoles.includes(e.id))))return;const s=e.mentions.users;s.size>=1&&(yield e.channel.send({embeds:[(0,replaceAll_1.default)(__1.client.messages.Embeds.GhostPingDetectedEmbed,{"{author-tag}":e.author.tag,"{author-username}":e.author.username,"{mentioned-username}":`${s.first().username}`,"{mentioned-tag}":`${s.first().tag}`})]}))}const s=e.guild.channels.cache.get(null==t?void 0:t.logChannel);s&&(yield s.send({embeds:[(0,replaceAll_1.default)(__1.client.messages.Logs.MessageDeleted,{"{author}":e.author.toString(),"{author-tag}":e.author.tag,"{channel}":e.channel.toString(),"{message-url}":e.url,"{message}":e.cleanContent.slice(0,1018)})]}))}))));