"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),discord_js_1=require("discord.js"),isVoiceChannel_1=tslib_1.__importDefault(require("../../helpers/isVoiceChannel")),replaceAll_1=tslib_1.__importDefault(require("../../helpers/replaceAll")),parseStyle_1=tslib_1.__importDefault(require("../../helpers/parseStyle")),Event_1=require("../../structures/Event"),distube_1=require("distube"),__1=require("../..");exports.default=new Event_1.Event("interactionCreate",(e=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){var s;if(!e.isButton())return;if(!e.customId.startsWith("music-"))return;if(!(0,isVoiceChannel_1.default)(e,!1))return;yield e.deferUpdate();const t=e.customId.replace("music-",""),u=__1.client.distube.getQueue(e.guildId);if(!(null===(s=null==u?void 0:u.songs)||void 0===s?void 0:s.length))return e.followUp({embeds:[(0,replaceAll_1.default)(__1.client.messages.Embeds.MusicNoSongEmbed)],ephemeral:!0});if("pause"===t)return u.pause(),u.paused=!0,e.editReply({components:[(new discord_js_1.ActionRowBuilder).addComponents((new discord_js_1.ButtonBuilder).setCustomId("music-previous").setLabel(__1.client.messages.Buttons.Previous.Label).setEmoji(__1.client.messages.Buttons.Previous.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Previous.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-stop").setLabel(__1.client.messages.Buttons.Stop.Label).setEmoji(__1.client.messages.Buttons.Stop.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Stop.Style)),(new discord_js_1.ButtonBuilder).setCustomId(u.paused?"music-resume":"music-pause").setLabel(__1.client.messages.Buttons[u.paused?"Resume":"Pause"].Label).setEmoji(__1.client.messages.Buttons[u.paused?"Resume":"Pause"].Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons[u.paused?"Resume":"Pause"].Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-skip").setLabel(__1.client.messages.Buttons.Skip.Label).setEmoji(__1.client.messages.Buttons.Skip.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Skip.Style))),(new discord_js_1.ActionRowBuilder).addComponents((new discord_js_1.ButtonBuilder).setCustomId("music-volume.down").setLabel(__1.client.messages.Buttons.VolumeDown.Label).setEmoji(__1.client.messages.Buttons.VolumeDown.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.VolumeDown.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-volume.up").setLabel(__1.client.messages.Buttons.VolumeUp.Label).setEmoji(__1.client.messages.Buttons.VolumeUp.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.VolumeUp.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-loop").setLabel(__1.client.messages.Buttons.Loop.Label).setEmoji(__1.client.messages.Buttons.Loop.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Loop.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-shuffle").setLabel(__1.client.messages.Buttons.ShuffleQueue.Label).setEmoji(__1.client.messages.Buttons.ShuffleQueue.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.ShuffleQueue.Style)))]});if("resume"===t)return u.resume(),u.paused=!1,e.editReply({components:[(new discord_js_1.ActionRowBuilder).addComponents((new discord_js_1.ButtonBuilder).setCustomId("music-previous").setLabel(__1.client.messages.Buttons.Previous.Label).setEmoji(__1.client.messages.Buttons.Previous.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Previous.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-stop").setLabel(__1.client.messages.Buttons.Stop.Label).setEmoji(__1.client.messages.Buttons.Stop.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Stop.Style)),(new discord_js_1.ButtonBuilder).setCustomId(u.paused?"music-resume":"music-pause").setLabel(__1.client.messages.Buttons[u.paused?"Resume":"Pause"].Label).setEmoji(__1.client.messages.Buttons[u.paused?"Resume":"Pause"].Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons[u.paused?"Resume":"Pause"].Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-skip").setLabel(__1.client.messages.Buttons.Skip.Label).setEmoji(__1.client.messages.Buttons.Skip.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Skip.Style))),(new discord_js_1.ActionRowBuilder).addComponents((new discord_js_1.ButtonBuilder).setCustomId("music-volume.down").setLabel(__1.client.messages.Buttons.VolumeDown.Label).setEmoji(__1.client.messages.Buttons.VolumeDown.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.VolumeDown.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-volume.up").setLabel(__1.client.messages.Buttons.VolumeUp.Label).setEmoji(__1.client.messages.Buttons.VolumeUp.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.VolumeUp.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-loop").setLabel(__1.client.messages.Buttons.Loop.Label).setEmoji(__1.client.messages.Buttons.Loop.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.Loop.Style)),(new discord_js_1.ButtonBuilder).setCustomId("music-shuffle").setLabel(__1.client.messages.Buttons.ShuffleQueue.Label).setEmoji(__1.client.messages.Buttons.ShuffleQueue.Emoji).setStyle((0,parseStyle_1.default)(__1.client.messages.Buttons.ShuffleQueue.Style)))]});if("stop"===t&&(yield u.stop().catch((e=>e)),e.editReply({components:[],embeds:[(0,replaceAll_1.default)(__1.client.messages.Embeds.MusicStopEmbed)]})),"skip"===t&&(yield u.skip().catch((e=>e))),"previous"===t&&(yield u.previous().catch((e=>e))),t.startsWith("volume.")){const e="up"===t.split(".")[1]?u.volume+10:u.volume-10;u.setVolume(e)}"loop"===t&&u.setRepeatMode(distube_1.RepeatMode.QUEUE),"shuffle"===t&&(yield u.shuffle())}))));