"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),discord_js_1=require("discord.js"),canvas_1=tslib_1.__importDefault(require("@napi-rs/canvas")),path_1=require("path");function generateBlackjackBoardImage({playerHand:e,dealerHand:a,dealerImage:t,playerImage:l,playerName:i,isFinished:n,title:d}){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const r=canvas_1.default.createCanvas(617,360),s=r.getContext("2d"),o=yield canvas_1.default.loadImage((0,path_1.join)(__dirname,"..","assets","images","blackjack-board.png"));s.drawImage(o,0,0,r.width,r.height),s.fillStyle="#282828",s.fillRect(45,45,100,140),s.fillStyle="#282828",s.fillRect(472,175,100,140);const c=yield canvas_1.default.loadImage(t);s.drawImage(c,45,45,100,100);const f=yield canvas_1.default.loadImage(l);s.drawImage(f,472,215,100,100);let g=152;for(const e of a){const a=yield canvas_1.default.loadImage((0,path_1.join)(__dirname,"..","assets","images",`${e.path}`));s.drawImage(a,g,45),g+=75}let u=397;for(const a of e){const e=yield canvas_1.default.loadImage((0,path_1.join)(__dirname,"..","assets","images",`${a.path}`));s.drawImage(e,u,215),u-=75}s.font="25px Poppins",s.fillStyle="#FFFFFF";const _=s.measureText(i).width,p=s.measureText("Dealer").width;s.fillText(i,(s.canvas.width-_)/2,345),s.fillText("Dealer",(s.canvas.width-p)/2,30);writeHandValue(s,a.reduce(((e,a)=>e+a.rank.value),0).toString(),[45,145],[145,185]);if(writeHandValue(s,e.reduce(((e,a)=>e+a.rank.value),0).toString(),[472,175],[572,215]),n){s.fillStyle="rgba(0, 0, 0, 0.7)",s.fillRect(0,0,r.width,r.height);const e=d.split("\n");s.fillStyle="#ffffff",s.font="40px Poppins";for(let a=0;a<e.length;a++)s.fillText(e[a],r.width/2,r.height/2+40*a)}const m=yield r.encode("png");return new discord_js_1.AttachmentBuilder(m,{name:"blackjack-board.png"})}))}function writeHandValue(e,a,t,l){e.fillStyle="#ffffff",e.font="30px Poppins",e.textAlign="center",e.textBaseline="middle",e.fillText(a,(t[0]+l[0])/2,(t[1]+l[1])/2)}exports.default=generateBlackjackBoardImage;