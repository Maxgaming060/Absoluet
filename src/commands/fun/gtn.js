"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),discord_js_1=require("discord.js"),Command_1=require("../../structures/Command"),replaceAll_1=tslib_1.__importDefault(require("../../helpers/replaceAll"));function randomNumbers(){const e=[];for(let t=0;t<25;t++){let t=Math.floor(1e3*Math.random()+1);e.includes(t)&&(t=Math.floor(1e3*Math.random()+1)),e.push(t)}return e}function getButtons(e,t=[],s=!1,o){const n=[];let r=new discord_js_1.ActionRowBuilder;for(const d of e){const e=(new discord_js_1.ButtonBuilder).setCustomId(d.toString()).setLabel(d.toString()).setDisabled(!!t.includes(d)||s).setStyle(o===d?discord_js_1.ButtonStyle.Success:t.includes(d)?discord_js_1.ButtonStyle.Danger:discord_js_1.ButtonStyle.Secondary);r.addComponents(e),5===r.components.length&&(n.push(r),r=new discord_js_1.ActionRowBuilder)}return r.components.length>0&&n.push(r),n}exports.default=new Command_1.Command({name:"gtn",description:"Guess a number between 1 and 1000",run:({client:e,interaction:t})=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){const s=[],o=randomNumbers(),n=o[Math.floor(Math.random()*o.length)],r=yield t.reply({embeds:[(0,replaceAll_1.default)(e.messages.Embeds.GuessTheNumberMain)],components:getButtons(o),fetchReply:!0}),d=r.createMessageComponentCollector({filter:e=>e.user.id===t.user.id,time:6e4});d.on("collect",(t=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){const l=parseInt(t.customId);return s.push(l),yield t.deferUpdate(),l===n?(yield r.edit({embeds:[(0,replaceAll_1.default)(e.messages.Embeds.GuessTheNumberSuccess,{"{number}":n,"{tries}":s.length})],components:getButtons(o,s,!0,n)}),d.stop("win")):s.length>=10?(r.edit({embeds:[(0,replaceAll_1.default)(e.messages.Embeds.GuessTheNumberOutChances,{"{number}":n})],components:getButtons(o,s,!0)}),d.stop()):(d.resetTimer(),void r.edit({embeds:[(0,replaceAll_1.default)(e.messages.Embeds.GuessTheNumberWrongSelect,{"{selected}":t.customId,"{tries}":10-s.length})],components:getButtons(o,s)}))})))),d.once("end",((t,d)=>{"time"===d&&r.edit({embeds:[(0,replaceAll_1.default)(e.messages.Embeds.GuessTheNumberOutTime,{"{number}":n})],components:getButtons(o,s,!0)})}))}))});