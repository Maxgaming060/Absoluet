"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),discord_js_1=require("discord.js"),replaceAll_1=tslib_1.__importDefault(require("../../helpers/replaceAll")),TicketModel_1=tslib_1.__importDefault(require("../../models/TicketModel")),Command_1=require("../../structures/Command");exports.default=new Command_1.Command({name:"add",description:"Add a user to a ticket",options:[{name:"user",description:"The user to add to the ticket",type:discord_js_1.ApplicationCommandOptionType.User,required:!0}],run:({interaction:e,client:s})=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){if(e.channel.type!==discord_js_1.ChannelType.GuildText)return;const i=e.options.getUser("user"),d=yield TicketModel_1.default.findOne({guildId:e.guildId,channelId:e.channelId});return d?d.usersInTicket.includes(i.id)?e.reply({embeds:[(0,replaceAll_1.default)(s.messages.Embeds.UserAlreadyInTicket)]}):(yield e.channel.permissionOverwrites.edit(i.id,{ViewChannel:!0,SendMessages:!0,AttachFiles:!0}),d.usersInTicket.push(i.id),yield d.save(),e.reply({embeds:[(0,replaceAll_1.default)(s.messages.Embeds.TicketUserAdded,{"{user}":i.toString(),"{user-id}":i.id,"{user-tag}":i.tag})]})):e.reply({embeds:[(0,replaceAll_1.default)(s.messages.Embeds.ChannelIsNotATicketEmbed)]})}))});
