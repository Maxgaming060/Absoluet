"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=require("tslib"),calculateReviews_1=tslib_1.__importDefault(require("../../helpers/calculateReviews")),Command_1=require("../../structures/Command"),replaceAll_1=tslib_1.__importDefault(require("../../helpers/replaceAll")),querys_1=require("../../helpers/querys");exports.default=new Command_1.Command({name:"serverinfo",description:"Get information about the server",run:({interaction:e,client:i})=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){const{guild:r}=e,s=yield e.guild.members.fetch({withPresences:!0}),t=yield(0,querys_1.guilds)().get(e.guildId),l=s.filter((e=>{var i,r;return(null===(i=e.presence)||void 0===i?void 0:i.status)&&"offline"!==(null===(r=e.presence)||void 0===r?void 0:r.status)})).size,o=s.size-l;e.reply({embeds:[(0,replaceAll_1.default)(i.messages.Embeds.ServerInfoEmbed,{"{server-name}":r.name,"{server-icon}":r.iconURL({size:4096}),"{owner-id}":r.ownerId,"{createdTimestamp}":Math.floor(r.createdTimestamp/1e3),"{online-members}":l,"{total-members}":s.size,"{online-percentage}":Math.floor(100*l/o),"{robotsCount}":s.filter((e=>e.user.bot)).size,"{boost-tier}":r.premiumTier||"None","{boosters}":s.filter((e=>e.premiumSinceTimestamp)).size,"{roles}":r.roles.cache.size,"{emojis}":r.emojis.cache.size,"{channels}":r.channels.cache.size,"{ticketRating}":(0,calculateReviews_1.default)(t.ticketReviews||[])})]})}))});